# Architecture

> Auto-generated by /map on 2026-02-19

## Overview

Automated Windows Development Setup is a PowerShell-based utility designed to automate the configuration of a fresh Windows environment for developers. It provides a graphical user interface (WPF/XAML) for software installation, git configuration, font management, and system settings backup/restore.

```
┌─────────────────────────────────────────┐
│              [GUI: setup.ps1]           │
├─────────────────────────────────────────┤
│ [Logic: winget/msstore] [Logic: Git/GH] │
├─────────────────────────────────────────┤
│ [Data: system-backup/]  [Config: nvim/] │
└─────────────────────────────────────────┘
```

## Components

### Main GUI (setup.ps1)
- **Purpose:** Central control panel for all automation tasks.
- **Location:** `setup.ps1`
- **Functionality:** Tabbed interface (Software, Setup, GitHub Repos, Backup/Restore) with dark/light mode toggle.

### Backup/Restore Engine
- **Purpose:** Handles Windows personalization, explorer settings, and PowerShell profile state.
- **Location:** `export-setting.ps1`, `import-settings.ps1`
- **Data Source:** `system-backup/` containing `.reg` files and `powershell-profile.ps1`.

### Editor Configurations
- **Purpose:** Pre-configured settings for productivity.
- **Location:** `nvim/` (Neovim settings), `wt-defaults.json` (Windows Terminal settings).

## Data Flow

1. **Software Installation:** User selects apps -> `setup.ps1` calls `winget install` or `msstore` commands.
2. **Settings Backup:** `export-setting.ps1` runs -> exports registry keys and copies profile to `system-backup/`.
3. **Settings Restore:** `import-settings.ps1` runs -> imports registry keys and copies profile back to user's Documents folder.
4. **Git Setup:** User enters credentials -> `setup.ps1` runs `git config --global`.

## Integration Points

| Service | Type | Purpose |
|---------|------|---------|
| Winget | CLI | Package management for software installation |
| GitHub | API/CLI | Repository discovery and cloning |
| Windows Registry | System | Storage for theme and explorer settings |

## Technical Debt

- [ ] UI logic and business logic are tightly coupled in `setup.ps1`.
- [ ] Error handling in background processes (like installation) could be more robust.
- [ ] No unit tests for registry manipulation logic.

## Conventions

**Naming:** PascalCase for functions/variables in PowerShell is common, but some scripts use camelCase.
**Structure:** Single-directory flat structure for main scripts with subdirectories for specific configs.
**Testing:** No formal testing framework observed.
